<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        html, body { color: #111; }
        .wrap { margin: 120px auto; max-width: 768px; }
        .table { table-layout: fixed; width: 100%; border-collapse: collapse; }
        .table th,
        .table td { position: relative; border: 1px solid #ddd; padding:10px 7px; color: #777; }
        .table .tooltip { display: none; position: absolute; top: 80%; left: 80%; z-index: 1; background: beige; padding: 8px; border:1px solid #111; border-radius: 4px; white-space: nowrap;}
        .table .tooltip.show { display: block; }
        .toolip--fixed { display: none; position: fixed; z-index: 999;width: 200px; background: beige; padding: 8px; border:1px solid #111; border-radius: 4px; white-space: nowrap; }
        .toolip--fixed.show { display: block; }
        a { color: inherit; }
    </style>
</head>
<body>
<div class="wrap">
    <table class="table">
        <colgroup>
            <col width="60">
            <col width="*">
            <col width="100">
            <col width="80">
            <col width="80">
        </colgroup>
        <thead>
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>글쓴이</th>
                <th>날짜</th>
                <th>조회수</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td align="center">57</td>
                <td>
                    <a href="#!">php 8.1에서 설치후 faq 클릭시 500에러</a>
                </td>
                <td align="center"><a href="#!" class="user">사용자23</a></td>
                <td align="center"><span>11-19</span></td>
                <td align="center"><span>357</span></td>
            </tr>
            <tr>
                <td align="center">56</td>
                <td>
                    <a href="#!">php 8.1에서 설치후 faq 클릭시 500에러</a>
                </td>
                <td align="center"><a href="#!" class="user">사용자21</a></td>
                <td align="center"><span>11-19</span></td>
                <td align="center"><span>357</span></td>
            </tr>
            <tr>
                <td align="center">55</td>
                <td>
                    <a href="#!">php 8.1에서 설치후 faq 클릭시 500에러</a>
                </td>
                <td align="center"><a href="#!" class="user">사용자17</a></td>
                <td align="center"><span>11-19</span></td>
                <td align="center"><span>357</span></td>
            </tr>
            <tr>
                <td align="center">53</td>
                <td>
                    <a href="#!">php 8.1에서 설치후 faq 클릭시 500에러</a>
                </td>
                <td align="center"><a href="#!" class="user">사용자</a></td>
                <td align="center"><span>11-19</span></td>
                <td align="center"><span>357</span></td>
            </tr>
            <tr>
                <td align="center">52</td>
                <td>
                    <a href="#!">php 8.1에서 설치후 faq 클릭시 500에러</a>
                </td>
                <td align="center"><a href="#!" class="user">사용자123</a></td>
                <td align="center"><span>11-19</span></td>
                <td align="center"><span>357</span></td>
            </tr>

            <tr>
                <td align="center">51</td>
                <td>
                    <a href="#!">php 8.1에서 설치후 faq 클릭시 500에러</a>
                </td>
                <td align="center"><a href="#!" class="user">사용자</a></td>
                <td align="center"><span>11-19</span></td>
                <td align="center"><span>357</span></td>
            </tr>
        </tbody>
    </table>
</div>

<script>
const $table = document.querySelector('table');

// function makeTooltipElement(userName) {
//     const $div = document.createElement('div');
//     $div.className = 'tooltip show';
//     $div.textContent = `Hello, ${userName}님.`;
//     return $div;
// }
function makeTooltipElement() {
    const $o = document.createElement('div');
    $o.classList.add('toolip--fixed');
    document.body.appendChild($o);
}

document.addEventListener('DOMContentLoaded', makeTooltipElement);

$table.addEventListener('click', function(e) {
    const $target = e.target || event.target;
    if ( $target.classList.contains('user') ) {
        const $tooltipBox = document.querySelector('.toolip--fixed');
        const oRect = $target.getBoundingClientRect();
        // 좌측끝, 하단끝에서 10px 덜 이동하도록. 
        $tooltipBox.style.left = (oRect.width + oRect.left - 10) + 'px';
        $tooltipBox.style.top = (oRect.height + oRect.top - 10) + 'px';
        $tooltipBox.textContent = `Hi ~ ${$target.textContent} 님`;
        $tooltipBox.classList.add('show');
        
        // if ( $target.nextElementSibling !== null ) {
        //     $target.nextElementSibling.classList.add('show');
        // } else {
        //     $target.parentNode.appendChild( makeTooltipElement($target.textContent) );
        // }
        
    }
})

document.addEventListener('click', function(event) {
    const $target = event.target;
    if ( $target.classList.contains('user') ||
        $target.classList.contains('toolip--fixed') ) {
        // 클릭요소중에 .user가 있다면, 해당 클릭 요소를 제외한 나머지 닫기.
        // $table.querySelectorAll('.show').forEach( elem => (elem.previousElementSibling !== $target) && elem.classList.remove('show') );
    } else {
        // 클릭 요소중에 .user 클레스가 없다면. 모든 tooltip 닫기.
    //    $table.querySelectorAll('.show').forEach( elem => elem.classList.remove('show') );
    const $tooltipBox = document.querySelector('.toolip--fixed');
    $tooltipBox.classList.remove('show');
    }
});

</script>
</body>
</html>